<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>name</h1>
    <input type="text" id="name" />
    <br />
    <h1>age</h1>
    <input type="text" id="age" />
    <br />
    <h1>email</h1>
    <input type="text" id="email" />
    <br />
    <button onclick="read()">Read</button>
    <button onclick="readAll()">Read All</button>
    <button onclick="add()">Add Data</button>
    <button onclick="remove()">Delete Data</button>
    <button onclick="update()">Update Data</button>
    <script>
      var db;
      var request = window.indexedDB.open("newDatabase", 1);
      request.onerror = function (event) {
        console.log("error: ");
      };
      request.onsuccess = function (event) {
        db = request.result;
        console.log("success: " + db);
      };
      ///tao doi tuong de luu tru
      request.onupgradeneeded = function (event) {
        console.log("1");
        var db = event.target.result;
        var objectStore = db.createObjectStore("employee", {
          autoIncrement: true,
        });

        var obj = {
          name: "Minh Triet",
          age: "21",
          email: "abc@gmail.com",
        };
        objectStore.add(obj);
      };
      function add() {
        let name = document.getElementById("name").value;
        let age = document.getElementById("age").value;
        let email = document.getElementById("email").value;
        var request = db.transaction(["employee"], "readwrite");
        request = request.objectStore("employee");
        request = request.add({ name: name, age: age, email: email });
          request.onsuccess = function(event) {
            console.log("Success");
          }
          request.onerror = function(event) {
            console.log("Error");
          }
      }
      function remove() {
        var request = db.transaction(["employee"], "readwrite");
        request = request.objectStore("employee");
        request.delete(1);
      }
      function update() {
        //cach viet ngan
        // var request = db.transaction(["employee"], "readwrite").objectStore('employee').put({name: "hello", age: "hello", email: "hello"},3)
        //cach viet dai
        var request = db.transaction(["employee"], "readwrite");
        request = request.objectStore("employee");
        request = request.put({ name: "taone", age: "taone", email: "taone"},3);
      }
      function read() {
        var request = db.transaction(["employee"], "readwrite").objectStore("employee").get(2);
        request.onerror = function(event) {
            console.log("Error");
          };
          request.onsuccess = function(event) {
           var result = request.result;
           console.log(result);
          };
      }
      function readAll() {
        var request = db.transaction(["employee"]).objectStore("employee").getAll();
        request.onerror = function(event) {
            console.log("Error");
          };
          request.onsuccess = function(event) {
           var result = request.result;
           console.log(result);
          };
      }
    </script>
  </body>
</html>